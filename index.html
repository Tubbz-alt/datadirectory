---
layout: mikes_layout
---
<!-- top banner  -->

{% include top_banner.html %}
<div class="top-banner">
  <div class="grid inner-container">
    <h1>
      revealing the products and projects using <br /> <strong>healthcare open data</strong> to make an impact
    </h1>
  </div>
</div>
<div class="main-container">
  <form class="form-search" style="margin-top: 20px">
    <div class="form-element"><input placeholder="Search ..." data-bind="value: currentFilter, valueUpdate: 'afterkeydown'" type="text"></input></div><!--
    --><div class="form-element"><select>
      <option>find stuff</option>
    </select></div><!--
    --><div class="form-element"><select class="select-box">
      <option>find other stuff</option>
    </select></div><!--
    --><div class="form-btn"><a class="btn 2btn-primary" href="">SEARCH</a></div>
  </form>
</div>
<div class="grid-description">
  <div data-bind="if: displayedItems().length === items().length" class="grid-description-title">Showing all <span data-bind="text: filteredItems().length"></span> projects</div>
  <div data-bind="if: displayedItems().length !== items().length" class="grid-description-title">Showing <span data-bind="text: displayedItems().length"></span> out of <span data-bind="text: items().length"></span>  projects</div>
  <hr>
</div>
<div class="main-container">
  <div class="project-grid-outer-container">
    <div data-bind="foreach: displayedItems" class="project-grid-inner-container grid"><div class="project-element-outer-container"><a data-bind="attr: { href: url }" class="project-element">
        <img data-bind="attr: {src: img}">
        <div class="project-element-text">
          <p data-bind="text: title" ></p>
          <p data-bind="text: author" ></p>
        </div>
    </a></div></div>
  </div>

  <nav data-bind="if: $root.numPages() > 1" style="text-align: center">
    <ul class="main-pagination">
        <li>
            <a href="#" data-bind="click: function(){ pageNumber(pageNumber() - 1)}, css: {disabled: pageNumber() === 0}">previous</a>
        </li>
        <!-- ko foreach: pagesArray -->
        <li><a href="#" data-bind="click: function(){ $root.pageNumber($index()) }, css: {active: $index() === $root.pageNumber()}">
          <span data-bind="text: $index() + 1"></span>
        </a></li>
        <!-- /ko -->
        <li>
            <a href="#" data-bind="click: function(){ pageNumber(pageNumber() + 1)}, css: {disabled: pageNumber() === ($root.pagesArray().length - 1)}">next</a>
        </li>
    </ul>
  </nav>


</div>
{% include mikes_footer.html %}
<div class="base-footer"></div>
<script>
  {{ site.posts | jsonify }}
  var json = [
  {% for post in site.posts %}
      {
        "title"   : "{{ post.title }}",
        "author"  : "{{ post.author }}",
        "url"     : "{{ post.url | prepend: site.baseurl }}",
        "img"     : "{{ post.imageurl }}"
      } {% if forloop.last %}{% else %},{% endif %}
  {% endfor %}
  ]

  var AppViewModel = function(){
      var self = this;
      var paginationAmount = 9;
      this.items = ko.observableArray(json);
      this.currentFilter = ko.observable();
      this.pageNumber = ko.observable(0);

      /*
        pagination will be done in blocks of 9
      */

      this.filteredItems = ko.computed(function() {
          if(!self.currentFilter() || !self.currentFilter().length){
              return self.items();
          } else {
              return ko.utils.arrayFilter(self.items(), function(prod) {
                  return prod.title.toLowerCase().indexOf(self.currentFilter().toLowerCase()) !== -1
              });
          }
      });

      this.numPages = ko.computed(function(){
          return Math.ceil(self.filteredItems().length/paginationAmount);
      });

      this.displayedItems = ko.computed(function(){
          var a = self.pageNumber()*paginationAmount;
          return self.filteredItems().slice(a, a + paginationAmount)
      });

      this.pagesArray = ko.computed(function(){ return new Array(self.numPages()) });
  }

  var mpv = new AppViewModel();
  window.mpv = mpv;
  ko.applyBindings(mpv);
</script>
